var t=require("jsdom");function e(){return e=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},e.apply(this,arguments)}function r(t){return t.toLocaleDateString("en-US")}describe("streakCounter",function(){var e;beforeEach(function(){var r=new t.JSDOM("",{url:"https://localhost"});e=r.window.localStorage}),it("should return a streak object with currentCount, startDate and lastLoginDate",function(){var t=new Date,r=a(e,t);expect(r.hasOwnProperty("currentCount")).toBe(!0),expect(r.hasOwnProperty("startDate")).toBe(!0),expect(r.hasOwnProperty("lastLoginDate")).toBe(!0)}),it("should return a streak starting at 1 and keep track of lastLoginDate",function(){var t=new Date,n=a(e,t),o=r(t);expect(n.currentCount).toBe(1),expect(n.lastLoginDate).toBe(o)}),it("should store the streak in localStorage",function(){var t=new Date;a(e,t);var r=e.getItem("streak");expect(r).not.toBeNull()}),describe("with a pre-populated streak",function(){var e;beforeEach(function(){var n=new t.JSDOM("",{url:"https://localhost"});e=n.window.localStorage;var a=new Date("12/12/2021"),o={currentCount:1,startDate:r(a),lastLoginDate:r(a)};e.setItem("streak",JSON.stringify(o))}),afterEach(function(){e.clear()}),it("should return the streak from localStorage",function(){var t=new Date,r=a(e,t);expect(r.startDate).toBe("12/12/2021")}),it("should increment the streak",function(){var t=new Date("12/13/2021"),r=a(e,t);expect(r.currentCount).toBe(2)}),it("should not increment the streak when login days not consecutive",function(){var t=new Date("12/14/2021"),r=a(e,t);expect(r.currentCount).toBe(1)}),it("should save the incremented streak to localStorage",function(){var t=new Date("12/13/2021");a(e,t);var r=e.getItem("streak"),n=JSON.parse(r||"");expect(n.currentCount).toBe(2)}),it("should reset if not consecutive",function(){var t=new Date("12/13/2021"),r=a(e,t);expect(r.currentCount).toBe(2);var n=new Date("12/15/2021"),o=a(e,n);expect(o.currentCount).toBe(1)}),it("should not reset the streak for same-day login",function(){var t=new Date("12/13/2021");a(e,t);var r=new Date("12/13/2021"),n=a(e,r);expect(n.currentCount).toBe(2)}),it("should save the reset streak to localStorage",function(){var t=new Date("12/13/2021");a(e,t);var r=new Date("12/15/2021");a(e,r);var n=e.getItem("streak"),o=JSON.parse(n||"");expect(o.currentCount).toBe(1)})})});var n="streak";function a(t,a){var o,s,c=t.getItem(n);if(c)try{var u=JSON.parse(c),i=(o=u.lastLoginDate,1==(s=a.getDate()-parseInt(o.split("/")[1]))?"increment":0!==s?"reset":void 0),l="reset"===i;if("increment"===i){var f=e({},u,{currentCount:u.currentCount+1,lastLoginDate:r(a)});return t.setItem(n,JSON.stringify(f)),f}if(l){var v=e({},u,{currentCount:1,lastLoginDate:r(a)});return t.setItem(n,JSON.stringify(v)),v}return u}catch(t){console.error("Failed to parse streak from localStorage")}var p=function(t,n){return e({currentCount:1,startDate:r(t),lastLoginDate:r(t)},{})}(a);return t.setItem(n,JSON.stringify(p)),p}exports.streakCounter=a;
//# sourceMappingURL=jest.config.cjs.map
